# 20161130

## BigInteger BigDecimal æ˜¯å¹²å•¥çš„ï¼Ÿä»€ä¹ˆåœ°æ–¹ç”¨ï¼Ÿ

è¿™ä¸¤ä¸ªç±»æ˜¯ java.math åŒ…ä¸‹é¢çš„ç±»ã€‚æ˜¾ç„¶è¿™ä¸¤ä¸ªç±»æ˜¯æä¾›æ•°æ®è¿ç®—ä½¿ç”¨çš„ã€‚

* æ”¯æŒçš„èŒƒå›´å¤Ÿå¤§, 

BigInteger è¦æ”¯æŒ(-2<sup>`Integer.MAX_VALUE`</sup>, +2<sup>`Integer.MAX_VALUE`</sup>)

BigDecimal çš„èŒƒå›´ï¼š unscaledValue Ã— 10<sup>-scale</sup>ï¼Œ 
ğŸ˜† è¿™ä¸ªæœ‰ç‚¹æŠ½è±¡äº†ï¼Œæ¥çœ‹BigDecimalçš„æºç ï¼š

```
/**
     * The unscaled value of this BigDecimal, as returned by {@link
     * #unscaledValue}.
     *
     * @serial
     * @see #unscaledValue
     */
    private final BigInteger intVal;

    /**
     * The scale of this BigDecimal, as returned by {@link #scale}.
     *
     * @serial
     * @see #scale
     */
    private final int scale;
```


* æ•°æ®è¦å‡† 

BigDecimalè¦æ”¯æŒå¤Ÿç²¾å‡†çš„æµ®ç‚¹è¿ç®—ï¼ˆè¿™ä¸ªæ¯”è¾ƒå¤æ‚ï¼Œç›®å‰æ²¡æœ‰ææ¸…ï¼‰

## Math vs StrictMath

java.lang ä¸‹é¢æœ‰ä¸¤ä¸ªmathçš„å·¥å…·ç±» **Math** and **StrictMath**

çœ‹æºç æ²¡æœ‰åŒºåˆ«å•Šï¼ŒMathä¸­è°ƒç”¨çš„æ˜¯StrictMathçš„ä»£ç ï¼Œ è€ŒStrictMathè°ƒç”¨çš„æ˜¯nativeçš„fdlibmï¼ˆFreely Distributable Math Libraryï¼Œ è¿™ä¸ªæ˜¯Cè¯­è¨€å†™çš„ï¼Œåº”è¯¥æ˜¯ä¸ªæ ‡å‡†ï¼‰

æ™’ä»£ç ğŸ˜

```
//Mathçš„
public static double sin(double a) {
        return StrictMath.sin(a); 
}

//StrictMathçš„
public static native double sin(double a);
```
é‚£æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ

æŸ¥äº†ä¸€ä¸‹èµ„æ–™è¯´æ˜¯ï¼š JVMåœ¨æ‰§è¡Œæ—¶ä¼šå¯¹Mathå’ŒStrictMathåŒºåˆ«å¯¹å¾…ï¼Œ Mathä¼šè°ƒç”¨æœ¬åœ°ç³»ç»Ÿçš„ç‰¹æ€§ï¼Œè€Œä¸æ˜¯éµå¾ªæ ‡å‡†ã€‚ç»™ä¸ªé“¾æ¥ï¼š <a href="http://stackoverflow.com/questions/4232231/whats-the-difference-between-java-lang-math-and-java-lang-strictmath">http://stackoverflow.com/questions/4232231/whats-the-difference-between-java-lang-math-and-java-lang-strictmath</a>

## Jacksonæ˜¯æ€æ ·è§£ææ•°æ®ç±»å‹



# 20161204

## Javaæ³›å‹--ç±»å‹å®‰å…¨çš„å¼‚æ„å®¹å™¨

è¿™ä¸ªæ¦‚å¿µæ˜¯ã€ŠEffective Javaã€‹ä¸­æå‡ºçš„æ¦‚å¿µï¼Œæ€è·¯å¾ˆæ–°é¢–ã€‚ç½‘ä¸Šæœ‰å¾ˆå¤šä¾‹å­ï¼Œç°åœ¨å…ˆç²˜è´´ä¸€ä¸ªå§ã€‚ä¾‹å­é“¾æ¥ï¼š  <a href="http://www.importnew.com/15556.html">http://www.importnew.com/15556.html</a>

æ³›å‹æ˜¯ç”¨æ¥åœ¨ç¼–è¯‘å™¨åšç±»å‹æ£€æŸ¥çš„ï¼ˆæ‰€ä»¥åœ¨è¿è¡Œæ—¶å…¶å®æ˜¯æ²¡æœ‰æ³›å‹ä»€ä¹ˆäº‹çš„ï¼Œ å†è§äº†æ‚¨è¯¶ï¼‰ï¼Œå¯ä»¥ä½¿æˆ‘ä»¬ä»ç±»å‹çš„å¼ºè½¬ä¸­è§£æ”¾å‡ºæ¥ã€‚

Naftalinå’ŒWadleræå‡ºäº†ä¸€ä¸ªæ³›å‹çš„æ³•åˆ™ï¼š PECS ï¼ˆproducer-extends, consumber-superï¼‰ã€‚è¿™ä¸ªç­‰åŒäºscalaä¸­çš„æ–œè¾¹å’Œé€†å˜ã€‚

> ä»€ä¹ˆæ˜¯<u>**ç±»å‹å®‰å…¨**</u>çš„<u>**å¼‚æ„å®¹å™¨**</u>

* æ³›å‹å¾ˆå¤šåº”ç”¨äºå®¹å™¨
* å®¹å™¨éœ€è¦æ³›å‹åšç±»å‹æ£€æŸ¥ï¼Œ å¦‚æœæˆ‘ä»¬è¦æ’å…¥ä¸åŒçš„ç±»å‹ç³»ç»Ÿï¼ˆä¸å­˜åœ¨ç»§æ‰¿å…³ç³»ï¼Œä¸èƒ½ä½¿ç”¨Bounded-Wild-typeï¼‰æ”¹æ€ä¹ˆåŠï¼Ÿ

ï¼ˆæˆ‘çš„ç†è§£è¿™é‡Œçš„å®¹å™¨æŒ‡çš„åº”è¯¥Mapç±»å‹ï¼‰

é¦–å…ˆã€‚æˆ‘ä»¬å¯ä»¥åœ¨Keyä¸­æ·»åŠ Valueçš„ç±»å‹ä¿¡æ¯ï¼Œæ¯”å¦‚ï¼š

```
public class Key<T> {
 
  final String identifier;
  final Class<T> type;
 
  public Key( String identifier, Class<T> type ) {
    this.identifier = identifier;
    this.type = type;
  }
}
```

å…¶æ¬¡ï¼Œ æˆ‘ä»¬éœ€è¦å°è£…ä¸€ä¸‹å®¹å™¨çš„setã€getæ–¹æ³•

```
public class MyContainer {
 
  private final Map<Key<?>, Object> values = new HashMap<>();
 
  public <T> void put( Key<T> key, T value ) {
    values.put( key, value );
  }
 
  public <T> T get( Key<T> key ) {
    return key.type.cast( values.get( key ) );
  }
 
}
```

æ³¨æ„ï¼š

è¿™é‡Œç”¨åˆ°äº†Classçš„cast()æ–¹æ³•ï¼Œå®ç°ä¼˜é›…çš„å¼ºè½¬

# 20161207

## BigDecimal

BigDecimal ï¼ˆå¤§å°æ•°ï¼Œè¿™é‡Œçš„decimalåº”è¯¥ç†è§£æˆå°æ•°ï¼Œè€Œä¸æ˜¯åè¿›åˆ¶ï¼‰ï¼Œæ˜¯å°†å°æ•°å˜æˆæ•´æ•°å»è¿ç®—ã€‚

```
æ¯”å¦‚ä¸€ä¸ªå°æ•°ï¼š 200.568
```

å¯¹åº”çš„BigDecimalæ˜¯ï¼š 200568 Ã— 10 <sup>3</sup> 

è¿™é‡Œï¼š

```
unscaledvalue=200568
scale=3
precision=6
```

ä¸€ä¸ªdecimalçš„ç»´åº¦ä¿¡æ¯æœ‰ä¸¤ä¸ªï¼ˆprecision, scaleï¼‰, ç”±è¿™ä¸¤ä¸ªç»´åº¦å¼•å‘çš„è¿‘ä¼¼çš„è®¡ç®—ç­–ç•¥

### æ„Ÿå—

è®¡ç®—æœºçš„ç»„æˆåŸç†åº”è¯¥æ›´é€‚åˆå¯¹æ•´æ•°è¿›è¡Œè¿ç®—ï¼Œ**å¯¹äºå°æ•°ï¼ˆæµ®ç‚¹æ•°ï¼‰çš„è®¡ç®—æ˜¯æ€ä¹ˆåšçš„å‘¢**ï¼Ÿ

> ä¸ªäººè§è§£ï¼š

ç»“ç®—æœºæ˜¯äºŒè¿›åˆ¶çš„ï¼Œå½“ç„¶ä¹Ÿå°±æ— æ‰€è°“çš„å°æ•°ï¼Œå°æ•°åœ¨è®¡ç®—æœºä¸­çš„å­˜å‚¨ä¼šæ¢ç®—æˆæ•´æ•°çš„å½¢å¼ï¼Œå°±æ˜¯Javaä¸­æåˆ°çš„å±æ€§ï¼š

* unscaledvalue
* scale
* åŸºæ•°

æˆ‘åœ¨ç½‘ä¸Šæœäº†ä¸€ä¸‹ï¼Œæœ‰çš„æ–‡ç« ä¸­æåˆ°çš„floatåœ¨å†…å­˜ä¸­çš„ç»“æ„å¦‚ä¸‹ï¼š

```
|-ç¬¦å·ä½-|------æŒ‡æ•°ä½----|--------------å°¾æ•°ä½-------------|
```

è¿™ä¸ªè¿˜æ˜¯å¾ˆæœ‰æ„æ€çš„ï¼Œéœ€è¦ç†è§£ä¸€ä¸‹è®¡ç®—ä¸­å¦‚ä½•å­˜å‚¨å°æ•°ï¼Ÿä»€ä¹ˆæ˜¯æµ®ç‚¹æ•°ï¼Ÿå’Œå°æ•°æ˜¯ä¸€ä¸ªæ¦‚å¿µä¹ˆï¼Ÿ

> Hive ä¸­çš„Decimal(precision, scale)

hiveä¸­çš„decimalç›¸å½“äºæ˜¯javaä¸­çš„bigdecimal

å£°æ˜decimalæ–¹æ³•å¦‚ä¸‹ï¼š

```
price decimal(12, 2),
amount decimal
```

å¦‚æœprecisionå’Œscaleéƒ½ä¸å£°æ˜ï¼Œé‚£ä¹ˆé»˜è®¤æ˜¯ï¼š

```
decimal(10, 0)
```

Java and most other modern languages use <a href="https://en.wikipedia.org/wiki/IEEE_floating_point">IEEE floating point </a>representation for floats or doubles.

This standard defines various stuff related to floating-point representations; the specific format for float and double datatypes is specified by IEEE 754-1985.

The 32 bit float representation is the one discussed by Adam Helps.
